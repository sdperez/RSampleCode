load(warpbreaks)
data(warpbreaks)
names(warpbreaks)
a1<-aov(breaks~wool + tension, data=warpbreaks)
summary(a1)
odds<-.2/(1-.2)
log(odds)
library(glm2)
install.packages("glm2")
library(glm2)
data(crabs)
names(crabs)
glm
glm1 <- glm(Satellites ~ width,data=crabs,family="poisson")
names(crabs)
glm1 <- glm(Satellites ~ Width,data=crabs,family="poisson")
summary(glm1)
exp(.1640)
exp(-3.30476+(.16405*22))
data(quine)
library(MASS)
data(quine)
lm1 = lm(log(Days + 2.5) ~.,data=quine)
select<-step(lm1)
library(ElemStatLearn)
data(SAheart)
set.seed(8484)
train = sample(1:dim(SAheart)[1],size=dim(SAheart)[1]/2,replace=F)
trainSA = SAheart[train,]
testSA = SAheart[-train,]
names(SAheart)
glm1 <- glm(chd ~ age + alcohol+ obesity+ tobacco+typea+ldl
,family="binomial",data=trainSA)
str(glm1)
missClass(glm1$chd, glm1$linear.predictors)
missClass = function(values,prediction){sum(((prediction > 0.5)*1) != values)/length(values)}
missClass(glm1$chd, glm1$linear.predictors)
missClass(glm1$data$chd, glm1$linear.predictors)
pred<-predict(glm1,newdata=testSA)
missClass(testSA$chd, pred)
library(pgmm)
data(olive)
olive = olive[,-1]
install.packages("pqmm")
install.packages("pgmm")
library(pgmm)
data(olive)
olive = olive[,-1]
olive = olive[,-1]
data(olive)
olive = olive[,-1]
tr1<-tree(Area~.,data=olive)
library(tree)
tr1<-tree(Area~.,data=olive)
newdata = as.data.frame(t(colMeans(olive)))
predict(tr1,newdata)
View(olive)
pruneTree <- prune.tree(tr1,best=6)
pruneTree <- prune.tree(tr1,best=4)
plot(pruneTree)
pruneTree <- prune.tree(tr1,best=5)
plot(pruneTree)
text(pruneTree)
pruneTree <- prune.tree(tr1,best=6)
plot(pruneTree)
text(pruneTree)
plot(tr1)
data(olive)
olive = olive[,-1]
tr1<-tree(Area~.,data=olive)
plot(tr1)
pruneTree <- prune.tree(tr1,best=5)
plot(pruneTree)
text(pruneTree)
tr1<-tree(as.factor(Area)~.,data=olive)
newdata = as.data.frame(t(colMeans(olive)))
predict(tr1,newdata)
newdata = as.data.frame(t(colMeans(olive)))
predict(tr1,newdata)
tr1<-tree(as.factor(Area)~.,data=olive, type='class')
predict(tr1,newdata,type='class')
View(newdata)
predict(tr1,newdata[,-1],type='class')
predict(tr1,newdata[,-1])
View(olive)
pruneTree <- prune.tree(tr1,best=6)
plot(pruneTree)
text(pruneTree)
newData = data.frame(Palmitic = 1200, Palmitoleic = 120, Stearic=200,
Oleic=7000,Linoleic = 900,
Linolenic = 32, Arachidic=60,Eicosenoic=6)
predict(pruneTree,newData)
predict(pruneTree,newData,type='class')
View(SAheart)
class(trainSA$chd)
glm1 <- glm(as.factor(chd) ~ age + alcohol+ obesity+ tobacco+typea+ldl
,family="binomial",data=trainSA)
missClass(glm1$data$chd, glm1$linear.predictors)
missClass(as.factor(glm1$data$chd), glm1$linear.predictors)
pred<-predict(glm1,newdata=testSA)
missClass(testSA$chd, pred)
names(SAheart)
View(olive)
tr1<-tree(as.factor(Area)~.,data=olive)
newdata = as.data.frame(t(colMeans(olive)))
View(newdata)
predict(tr1,newdata[,-1])
predict(tr1,newdata)
summary(tr1)
plot(tr1)
text(tr1)
predict(tr1,newdata=newdata)
predict(tr1,olive)
tr1<-tree(Area~.,data=olive)
summary(tr1)
plot(tr1)
text(tr1)
newdata = as.data.frame(t(colMeans(olive)))
predict(tr1,newdata)
glm1 <- glm(as.factor(chd) ~ age + alcohol+ obesity+ tobacco+typea+ldl
,family="binomial",data=trainSA)
summary(glm1)
missClass(as.factor(glm1$data$chd), glm1$linear.predictors)
pred1<-predict(glm1,newdata=trainSA)
fix(pred1)
fix(pred)
missClass(glm1$data$chd, pred1)
missClass(glm1$data$chd, pred1)
glm1 <- glm(chd ~ age + alcohol+ obesity+ tobacco+typea+ldl
,family="binomial",data=SAheart)
pred1<-predict(glm1,newdata=trainSA)
missClass(glm1$data$chd, pred1)
pred<-predict(glm1,newdata=testSA)
missClass(testSA$chd, pred)
pred1<-predict(glm1,newdata=trainSA,type='response')
missClass(glm1$data$chd, pred1)
glm1 <- glm(chd ~ age + alcohol+ obesity+ tobacco+typea+ldl
,family="binomial",data=trainSA)
pred1<-predict(glm1,newdata=trainSA,type='response')
missClass(glm1$data$chd, pred1)
pred<-predict(glm1,newdata=testSA,type='response')
missClass(testSA$chd, pred)
predict(tr1,newdata)
library(ggplot2)
library(doBy)
library(Hmisc)
setwd("C:/Users/sdperez.EMORYUNIVAD/Desktop/My Documents/Studies/KnechtleLiverTxCost")
load('./Data/mergedData2.rda')
names(alldat)
table (alldat$Alive)
table(alldat$GraftFunctioning)
alldat$SurvDays<-alldat$DateofDeath-alldat$TxDate
class(alldat$DateofDeath)
class(alldat$TxDate)
alldat$SurvDays<-as.Date(alldat$DateofDeath)-alldat$TxDate
alldat$DDate<-as.Date(as.character(alldat$DateofDeath),"%m/%d/%Y")
alldat$SurvDays<-alldat$DDate-alldat$TxDate
summary(alldat$SurvDays)
summary(as.numeric(alldat$SurvDays))
summary(as.numeric(alldat$DDate))
alldat$DateofDeath[1:10]
alldat$DDate<-as.Date(as.character(alldat$DateofDeath))
alldat$DDate<-as.Date(as.character(alldat$DateofDeath),"%Y-%m-%d")
summary(as.numeric(alldat$DDate))
hist(alldat$DDate)
alldat$SurvDays<-alldat$DDate-alldat$TxDate
summary(as.numeric(alldat$SurvDays))
summary(alldat$SurvDays)
subset<-alldat[,!is.na(Alive)]
subset<-alldat[,!is.na(alldat$Alive)]
subset<-alldat[,alldat$Alive!=NA]
subset<-alldat[,alldat$Alive==1]
subset<-alldat[alldat$Alive==1,]
subset<-alldat[alldat$Alive!=NA,]
table(alldat$Alive)
subset<-alldat[alldat$Alive!='',]
summary(as.numeric(subset$SurvDays))
names(alldat)
table(subset$Alive,subsetBMICat)
table(subset$Alive,subset$BMICat)
alldat$BMICat<-cut(alldat$BMI,breaks=c(0,30,35,65))
alldat$BMI=alldat$Weightattimeoftransplantkg/((alldat$Heightattimeoftransplantcm/100)^2)
alldat$BMICat<-cut(alldat$BMI,breaks=c(0,30,35,65))
table(alldat$BMICat)
subset<-alldat[alldat$Alive!='',]
table(subset$Alive,subset$BMICat)
table(factor(subset$Alive),subset$BMICat)
prop.table(table(factor(subset$Alive),subset$BMICat))
prop.table(table(factor(subset$Alive),subset$BMICat),margin=2)
chisq.test(factor(subset$Alive),subset$BMICat)
table(alldat$GraftFunctioning)
subset2<-alldat[alldat$GraftFunctioning!='',]
prop.table(table(factor(subset$GraftFunctioning),subset$BMICat),margin=2)
chisq.test(factor(subset$GraftFunctioning),subset$BMICat)
chisq.test(factor(subset$Alive),subset$BMICat,simulate.p.value=TRUE)
chisq.test(factor(subset$GraftFunctioning),subset$BMICat,simulate.p.value=TRUE)
library(ggplot2)
library(doBy)
library(Hmisc)
setwd("C:/Users/sdperez.EMORYUNIVAD/Desktop/My Documents/Studies/KnechtleLiverTxCost")
load('./Data/mergedData2.rda')
alldat$BMI=alldat$Weightattimeoftransplantkg/((alldat$Heightattimeoftransplantcm/100)^2)
alldat$BMICat<-cut(alldat$BMI,breaks=c(0,30,35,65))
table(alldat$BMICat)
library(ggplot2)
library(doBy)
library(Hmisc)
setwd("C:/Users/sdperez.EMORYUNIVAD/Desktop/My Documents/Studies/KnechtleLiverTxCost")
load('./Data/mergedData2.rda')
alldat$BMI=alldat$Weightattimeoftransplantkg/((alldat$Heightattimeoftransplantcm/100)^2)
alldat$BMICat<-cut(alldat$BMI,breaks=c(0,30,35,65))
table(alldat$BMICat)
boxplot(TCosts~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Transplant Costs(log)')
bnames<-c('0 to 30','31 to 35','35 to 65')
boxplot(TCosts~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Transplant Costs(log)')
text(3,12.5,"p-value=.386")
boxplot(format(TCosts,scientific=FALSE)~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Transplant Costs(log)')
boxplot(format(alldat$TCosts,scientific=FALSE)~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Transplant Costs(log)')
options(scipen=10)
boxplot(TCosts~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Transplant Costs(log)')
boxplot(logTCosts~BMICat,data=alldat,names=bnames, xlab='BMI',ylab='Transplant Costs(log)')
boxplot(TCosts~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Transplant Costs(log scale)')
text(3,2000,"p-value=.386")
text(3,2300,"p-value=.386")
text(3,2,"p-value=.386")
text(3,20000,"p-value=.386")
text(3,23000,"p-value=.386")
boxplot(Total1yrCosts~BMICat,data=alldat,names=bnames,,log='y', xlab='BMI',ylab='1 YR Costs(log)')
text(3,44000,"p-value=.873")
boxplot(Total1yrCosts~BMICat,data=alldat,names=bnames,log='y', xlab='BMI',ylab='1 YR Costs(log)')
text(3,44000,"p-value=.873")
text(3,30000,"p-value=.873")
text(3,23000,"p-value=.873")
text(3,22000,"p-value=.873")
boxplot(Total1yrCosts~BMICat,data=alldat,names=bnames,log='y', xlab='BMI',ylab='1 YR Costs(log)')
text(3,22000,"p-value=.873")
boxplot(logtotdays~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Length of Stay(log)')
boxplot(as.numeric(alldat$LOScalc)~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Length of Stay(log)')
par(mfcol=c(1,3))
boxplot(TCosts~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Transplant Costs(log scale)')
text(3,23000,"p-value=.386")
#BMI Category and Cost (1 year)
summary(aov(logTot1yCost~BMICat,data=alldat))
boxplot(Total1yrCosts~BMICat,data=alldat,names=bnames,log='y', xlab='BMI',ylab='1 YR Costs(log scale)')
text(3,22000,"p-value=.873")
#BMI Category and LOS
summary(aov(logtotdays~BMICat,data=alldat))
boxplot(as.numeric(alldat$LOScalc)~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Length of Stay Days(log scale)')
text(3,0.5,"p-value=.626")
boxplot(as.numeric(alldat$LOScalc)~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Length of Stay Days(log scale)')
text(3,2,"p-value=.626")
text(2.5,2,"p-value=.626")
boxplot(TCosts~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Transplant Costs(log scale)')
text(3,23000,"p-value=.386")
#BMI Category and Cost (1 year)
summary(aov(logTot1yCost~BMICat,data=alldat))
boxplot(Total1yrCosts~BMICat,data=alldat,names=bnames,log='y', xlab='BMI',ylab='1 YR Costs(log scale)')
text(3,22000,"p-value=.873")
#BMI Category and LOS
summary(aov(logtotdays~BMICat,data=alldat))
boxplot(as.numeric(alldat$LOScalc)~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Length of Stay Days(log scale)')
text(2.5,2,"p-value=.626")
par(mfcol=c(1,3))
boxplot(TCosts~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Transplant Costs(log scale)')
text(3,23000,"p-value=.386")
#BMI Category and Cost (1 year)
summary(aov(logTot1yCost~BMICat,data=alldat))
boxplot(Total1yrCosts~BMICat,data=alldat,names=bnames,log='y', xlab='BMI',ylab='1 YR Costs(log scale)')
text(3,22000,"p-value=.873")
#BMI Category and LOS
summary(aov(logtotdays~BMICat,data=alldat))
boxplot(as.numeric(alldat$LOScalc)~BMICat,data=alldat,names=bnames,log="y", xlab='BMI',ylab='Length of Stay Days(log scale)')
text(2.5,2,"p-value=.626")
alldat$BMICat2<-cut(alldat$BMI,breaks=c(0,20,30,35,65))
table(alldat$Alive)
alldat$DDate<-as.Date(as.character(alldat$DateofDeath),"%Y-%m-%d")
summary(as.numeric(alldat$DDate))
subset<-alldat[alldat$Alive!='',]
prop.table(table(factor(subset$Alive),subset$BMICat2),margin=2)
table(alldat$BMICat2)
prop.table(table(factor(subset$Alive),subset$BMICat),margin=2)
subset$DDate<-as.Date(as.character(subset$DateofDeath),"%Y-%m-%d")
summary(as.numeric(subset$DDate))
lastFDate<-as.Date("2012-3-1","%Y-%m-%d")
subset$Fdate<-pmin(subset$DateofDeath,lastDate,na.rm=TRUE)
lastDate<-as.Date("2012-3-1","%Y-%m-%d")
subset$Fdate<-pmin(subset$DateofDeath,lastDate,na.rm=TRUE)
subset$DDate<-as.Date(as.character(subset$DateofDeath),"%Y-%m-%d")
summary(as.numeric(subset$DDate))
summary(subset$DDate)
class(subset$DDate)
subset$Fdate<-pmin(subset$DDate,lastDate,na.rm=TRUE)
lastDate<-as.Date("2013-05-23","%Y-%m-%d")
subset$Fdate<-pmin(subset$DDate,lastDate,na.rm=TRUE)
xmatch.dat$Ftime<-subset$Fdate-subset$Txdate
subset$Ftime<-subset$Fdate-subset$Txdate
names(alldat)
subset$Ftime<-subset$Fdate-subset$TxDate
class(subset$Ftime)
table(alldat$Alive)
subset$IndDeath<-subset$Alive=='No'
surv.obj<-Surv(as.numeric(subset$$Ftime), subset$IndDeath)
surv.obj<-Surv(as.numeric(subset$Ftime), subset$IndDeath)
rej.fit<-survfit(surv.obj~subset$BMICat)
summary(rej.fit)
plot(rej.fit, col=c(2,4))
par(mfcol=c(1,1))
plot(rej.fit, col=c(2,4))
legend(40, .2, levels(subset$BMICat), lty=1,col=c(2,4))
plot(rej.fit, col=c(2,4,6))
legend(40, .2, levels(subset$BMICat), lty=1,col=c(2,4,6))
plot(rej.fit, col=c(2,4,1))
legend(40, .2, levels(subset$BMICat), lty=1,col=c(2,4,1))
survdiff(surv.obj~subset$BMICat)
table(alldat$GraftFunctioning)
prop.table(table(factor(subset$GraftFunctioning),subset$BMICat),margin=2)
table(factor(subset$GraftFunctioning)
,subset$BMICat)
table(factor(subset$GraftFunctioning),subset$Alive)
table(Deathwithfunctioninggraft,subset$Alive)
table(subset$Deathwithfunctioninggraft,subset$Alive)
library(ggplot2)
library(doBy)
library(Hmisc)
setwd("C:/Users/sdperez.EMORYUNIVAD/Desktop/My Documents/Studies/KnechtleLiverTxCost")
load('./Data/mergedData2.rda')
options(scipen=10) #minimizes use of scientific notation
alldat$BMI=alldat$Weightattimeoftransplantkg/((alldat$Heightattimeoftransplantcm/100)^2)
summary(alldat$BMI)
297-34
cost1<-read.xlsx("./Data/Initial data merge 10.30.13Lauren.xlsx",1)
library(xlsx)
cost1<-read.xlsx("./Data/Initial data merge 10.30.13Lauren.xlsx",1)
names(cost1)[1]<-"EUH.Encounter" #fixed the name
sapply(cost1, class)
#turn encounter number into numeric
cost1$FixedEncounter<-as.numeric(as.character(cost1$EUH.Encounter))
length(which(is.na(cost1$FixedEncounter)))
which(is.na(cost1$FixedEncounter))
cost1$EUH.Encounter[369]
#Delete the whole last line of data
cost1<-cost1[-369,]
mrns<-read.xlsx("./Data/EUH Account and MRN for Sebastian.xlsx",1)
alldat$BMICat2<-cut(alldat$BMI,breaks=c(0,20,30,35,65))
table(alldat$BMICat2)#only nine patient under 20 and all are alive
table(alldat$Alive)
summary as.numeric(alldat$LOS)
summary( as.numeric(alldat$LOS))
summary( as.numeric(alldat$LOScalc))
install.packages("shiny")
library(shiny)
runExample("01_hello")
runExample("02_text")
runApp("~/shinyapp")
setwd(C:/Users/sdperez.EMORYUNIVAD/Desktop/My Documents/R/RSampleCode)
setwd('C:/Users/sdperez.EMORYUNIVAD/Desktop/My Documents/R/RSampleCode')
runApp("~/shinyapp")
runApp("./shinyapp")
runApp("./shinyapp")
runApp("./shinyapp")
runApp("./shinyapp")
runApp("./shinyapp")
runApp("./shinyapp")
install.packages("googleVis")
library(googleVis)
demo(WorldBank)
print(M, file='C:/Users/sdperez.EMORYUNIVAD/Desktop/My Documents/R/RSampleCode/GooglevisEx/motion.html')
